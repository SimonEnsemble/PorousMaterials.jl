<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="author" content="SimonEnsemble">
    
    <link rel="shortcut icon" href="../../img/favicon.ico">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Boxes, Crystals, and Grids - </title>
    <link href="../../css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="../../css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="../../css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="../../css/highlight.css">
    <link href="../../assets/Documenter.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="../../js/jquery-3.2.1.min.js"></script>
    <script src="../../js/bootstrap-3.3.7.min.js"></script>
    <script src="../../js/highlight.pack.js"></script>
    
    <base target="_top">
    <script>
      var base_url = '../..';
      var is_top_frame = false;
        
        var pageToc = [
          {title: "Loading in Crystal Structure Files", url: "#_top", children: [
          ]},
          {title: "Building Blocks of PorousMaterials: Bravais lattice", url: "#building-blocks-of-porousmaterials-bravais-lattice", children: [
          ]},
          {title: "Building Blocks of PorousMaterials: Porous Crystals", url: "#building-blocks-of-porousmaterials-porous-crystals", children: [
          ]},
          {title: "Demo of Potential Energy Grid", url: "#demo-of-potential-energy-grid", children: [
          ]},
          {title: "Boxes", url: "#boxes", children: [
          ]},
          {title: "Crystals", url: "#crystals", children: [
          ]},
          {title: "Grids", url: "#grids", children: [
          ]},
        ];

    </script>
    <script src="../../js/base.js"></script>
      <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS_HTML"></script>
      <script src="../../assets/mathjaxhelper.js"></script>
      <script src="../../mathjax-config.js"></script> 
</head>

<body>
<script>
if (is_top_frame) { $('body').addClass('wm-top-page'); }
</script>



<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../molecules/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../molecules/" class="btn btn-xs btn-link">
        Molecules
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../matter/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../matter/" class="btn btn-xs btn-link">
        Matter
      </a>
    </div>
    
  </div>

    

    <p><a id='Loading-in-Crystal-Structure-Files-1'></a></p>
<h2 id="loading-in-crystal-structure-files">Loading in Crystal Structure Files<a class="headerlink" href="#loading-in-crystal-structure-files" title="Permanent link">#</a></h2>
<p>Place <code>.cif</code> and <code>.cssr</code> crystal structure files in <code>data/crystals</code>. <code>PorousMaterials.jl</code> currently takes crystals in P1 symmetry only. From here you can start julia and do the following to load a framework and start working with it.</p>
<pre><code class="julia">using PorousMaterials

f = Framework(&quot;SBMOF-1.cif&quot;)
</code></pre>

<p>PorousMaterials will then output information about the framework you just loaded:</p>
<pre><code class="julia">Name: SBMOF-1.cif
Bravais unit cell of a crystal.
        Unit cell angles α = 90.000000 deg. β = 100.897000 deg. γ = 90.000000 deg.
        Unit cell dimensions a = 11.619300 Å. b = 5.566700 Å, c = 22.931200 Å
        Volume of unit cell: 1456.472102 Å³

Number of atoms = 120
Number of charges = 0
Chemical formula: Dict(:H=&gt;8,:S=&gt;1,:Ca=&gt;1,:O=&gt;6,:C=&gt;14)
</code></pre>

<p><a id='Building-Blocks-of-PorousMaterials:-Bravais-lattice-1'></a></p>
<h2 id="building-blocks-of-porousmaterials-bravais-lattice">Building Blocks of PorousMaterials: Bravais lattice<a class="headerlink" href="#building-blocks-of-porousmaterials-bravais-lattice" title="Permanent link">#</a></h2>
<p>We later apply periodic boundary conditions to mimic a crystal of infinite extent. A <code>Box</code> describes a <a href="https://en.wikipedia.org/wiki/Bravais_lattice">Bravais lattice</a>.</p>
<p>To make a 10 by 10 by 10 Å Bravais lattice with right angles:</p>
<pre><code class="julia">box = Box(10.0, 10.0, 10.0, π/2, π/2, π/2)

box.a, box.b, box.c # unit cell dimensions (10.0 Å)
box.α, box.β, box.γ # unit cell angles (1.57... radians)
box.Ω # volume (1000.0 Å³)
box.f_to_c # fractional to Cartesian coordinate transformation matrix
box.c_to_f # Cartesian to fractional coordinate transformation matrix
box.reciprocal_lattice # rows are reciprocal lattice vectors
</code></pre>

<p>Replicate a box as follows:</p>
<pre><code class="julia">box = replicate(box, (2, 2, 2)) # new box replicated 2 by 2 by 2
box.a # 20 Å
</code></pre>

<p><a id='Building-Blocks-of-PorousMaterials:-Porous-Crystals-1'></a></p>
<h2 id="building-blocks-of-porousmaterials-porous-crystals">Building Blocks of PorousMaterials: Porous Crystals<a class="headerlink" href="#building-blocks-of-porousmaterials-porous-crystals" title="Permanent link">#</a></h2>
<pre><code class="julia">using PorousMaterials

# read in xtal structure file
framework = Framework(&quot;SBMOF-1.cif&quot;)

# access unit cell box
framework.box

# access Lennard-Jones spheres and point charges comprising the crystal
framework.atoms
framework.charges

# remove annoying numbers on the atom labels
strip_numbers_from_atom_labels!(framework)

# compute crystal density
ρ = crystal_density(framework) # kg/m3

# compute the chemical formula
cf = chemical_formula(framework)

# assign charges according to atom type
charges = Dict(:Ca =&gt; 3.0, :O =&gt; 2.0, :C =&gt; -1.0, :S =&gt; 7.0, :H =&gt; -1.0)
charged_framework = assign_charges(framework, charges)

# replicate &amp; visualize
framework = replicate(framework, (3, 3, 3))
write_to_xyz(framework, &quot;SBMOF-1.xyz&quot;)
</code></pre>

<p><a id='Demo-of-Potential-Energy-Grid-1'></a></p>
<h2 id="demo-of-potential-energy-grid">Demo of Potential Energy Grid<a class="headerlink" href="#demo-of-potential-energy-grid" title="Permanent link">#</a></h2>
<p>Superimpose a grid of points about the unit cell of SBMOF-1. Compute the potential energy of xenon at each point and store as a grid.</p>
<pre><code class="julia">using PorousMaterials

framework = Framework(&quot;SBMOF-1.cif&quot;)
molecule = Molecule(&quot;Xe&quot;)
forcefield = LJForceField(&quot;UFF.csv&quot;)

grid = energy_grid(framework, molecule, forcefield,
    n_pts=(50, 50, 50), units=:kJ_mol) # Grid data structure
</code></pre>

<p>Write to a .cube volume file to visualize the potential energy contours.</p>
<pre><code class="julia">write_cube(grid, &quot;CH4_in_SBMOF1.cube&quot;)
</code></pre>

<p><a id='Boxes-1'></a></p>
<h2 id="boxes">Boxes<a class="headerlink" href="#boxes" title="Permanent link">#</a></h2>
<p><a id='PorousMaterials.Box' href='#PorousMaterials.Box'>#</a>
<strong><code>PorousMaterials.Box</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>box = Box(a, b, c, α, β, γ, volume, f_to_c, c_to_f, reciprocal_lattice)
box = Box(a, b, c, α, β, γ)
box = Box(f_to_c)
</code></pre>

<p>Data structure to describe a unit cell box (Bravais lattice) and convert between fractional and Cartesian coordinates.</p>
<p><strong>Attributes</strong></p>
<ul>
<li><code>a,b,c::Float64</code>: unit cell dimensions (units: Angstroms)</li>
<li><code>α,β,γ::Float64</code>: unit cell angles (units: radians)</li>
<li><code>Ω::Float64</code>: volume of the unit cell (units: cubic Angtroms)</li>
<li><code>f_to_c::Array{Float64,2}</code>: the 3x3 transformation matrix used to map fractional</li>
</ul>
<p>coordinates to cartesian coordinates. The columns of this matrix define the unit cell axes. Columns are the vectors defining the unit cell box. units: Angstrom</p>
<ul>
<li><code>c_to_f::Array{Float64,2}</code>: the 3x3 transformation matrix used to map Cartesian</li>
</ul>
<p>coordinates to fractional coordinates. units: inverse Angstrom</p>
<ul>
<li><code>reciprocal_lattice::Array{Float64, 2}</code>: the <em>rows</em> are the reciprocal lattice vectors.</li>
</ul>
<p>This choice was made (instead of columns) for speed of Ewald Sums.</p>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Box.jl#L1-L20' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.replicate' href='#PorousMaterials.replicate'>#</a>
<strong><code>PorousMaterials.replicate</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>new_box = replicate(original_box, repfactors)
</code></pre>

<p>Replicates a <code>Box</code> in positive directions to construct a new <code>Box</code> representing a supercell. The <code>original_box</code> is replicated according to the factors in <code>repfactors</code>. Note <code>replicate(original_box, repfactors=(1, 1, 1))</code> returns same <code>Box</code>. The new fractional coordinates as described by <code>f_to_c</code> and <code>c_to_f</code> still ∈ [0, 1].</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>original_box::Box</code>: The box that you want to replicate</li>
<li><code>repfactors::Tuple{Int, Int, Int}</code>: The factor you want to replicate the box by</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>box::Box</code>: Fully formed Box object</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Box.jl#L118-L132' class='documenter-source'>source</a><br></p>
<pre><code>replicated_frame = replicate(framework, repfactors)
</code></pre>

<p>Replicates the atoms and charges in a <code>Framework</code> in positive directions to construct a new <code>Framework</code>. Note <code>replicate(framework, (1, 1, 1))</code> returns the same <code>Framework</code>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework to replicate</li>
<li><code>repfactors::Tuple{Int, Int, Int}</code>: The factors by which to replicate the crystal structure in each direction.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>replicated_frame::Framework</code>: Replicated framework</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L222-L234' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.UnitCube' href='#PorousMaterials.UnitCube'>#</a>
<strong><code>PorousMaterials.UnitCube</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>unit_cube = UnitCube()
</code></pre>

<p>This function generates a unit cube, each side is 1.0 Angstrom long, and all the corners are right angles.</p>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Box.jl#L110-L115' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.write_vtk' href='#PorousMaterials.write_vtk'>#</a>
<strong><code>PorousMaterials.write_vtk</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>write_vtk(box, filename; verbose=true)
write_vtk(framework)
</code></pre>

<p>Write a <code>Box</code> to a .vtk file for visualizing e.g. the unit cell boundary of a crystal. If a <code>Framework</code> is passed, the <code>Box</code> of that framework is written to a file that is the same as the crystal structure filename but with a .vtk extension.</p>
<p>Appends ".vtk" extension to <code>filename</code> automatically if not passed.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>box::Box</code>: a Bravais lattice</li>
<li><code>filename::AbstractString</code>: filename of the .vtk file output (absolute path)</li>
<li><code>framework::Framework</code>: A framework containing the crystal structure information</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Box.jl#L138-L152' class='documenter-source'>source</a><br></p>
<p><a id='Crystals-1'></a></p>
<h2 id="crystals">Crystals<a class="headerlink" href="#crystals" title="Permanent link">#</a></h2>
<p><a id='PorousMaterials.Framework' href='#PorousMaterials.Framework'>#</a>
<strong><code>PorousMaterials.Framework</code></strong> &mdash; <em>Type</em>.</p>
<pre><code>framework = Framework(filename, check_charge_neutrality=true,
                      net_charge_tol=0.001, check_atom_and_charge_overlap=true,
                      remove_overlap=false)
framework = Framework(name, box, atoms, charges)
</code></pre>

<p>Read a crystal structure file (.cif or .cssr) and populate a <code>Framework</code> data structure, or construct a <code>Framework</code> data structure directly.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>filename::AbstractString</code>: the name of the crystal structure file (include ".cif" or ".cssr") read from <code>joinpath(PorousMaterials.PATH_TO_DATA, "structures")</code>.</li>
<li><code>check_charge_neutrality::Bool</code>: check for charge neutrality</li>
<li><code>net_charge_tol::Float64</code>: when checking for charge neutrality, throw an error if the absolute value of the net charge is larger than this value.</li>
<li><code>check_atom_and_charge_overlap::Bool</code>: throw an error if overlapping atoms are detected.</li>
<li><code>remove_overlap::Bool</code>: remove identical atoms automatically. Identical atoms are the same element atoms which overlap.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>framework::Framework</code>: A framework containing the crystal structure information</li>
</ul>
<p><strong>Attributes</strong></p>
<ul>
<li><code>name::AbstractString</code>: name of crystal structure</li>
<li><code>box::Box</code>: unit cell (Bravais Lattice)</li>
<li><code>atoms::Atoms</code>: list of Atoms in crystal unit cell</li>
<li><code>charges::Charges</code>: list of point charges in crystal unit cell</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L11-L35' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.remove_overlapping_atoms_and_charges' href='#PorousMaterials.remove_overlapping_atoms_and_charges'>#</a>
<strong><code>PorousMaterials.remove_overlapping_atoms_and_charges</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>new_framework = remove_overlapping_atoms_and_charges(framework, overlap_tol=0.1, verbose=true)
</code></pre>

<p>Takes in a framework and returns a new framework with where overlapping atoms and overlapping charges were removed. i.e. if there is an overlapping pair, one in the pair is removed. For any atoms or charges to be removed, the species and charge, respectively, must be identical.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework containing the crystal structure information</li>
<li><code>atom_overlap_tol::Float64</code>: The minimum distance between two atoms that is tolerated</li>
<li><code>charge_overlap_tol::Float64</code>: The minimum distance between two charges that is tolerated</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>new_framework::Framework</code>: A new framework where identical atoms have been removed.</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L364-L379' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.strip_numbers_from_atom_labels!' href='#PorousMaterials.strip_numbers_from_atom_labels!'>#</a>
<strong><code>PorousMaterials.strip_numbers_from_atom_labels!</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>strip_numbers_from_atom_labels!(framework)
</code></pre>

<p>Strip numbers from labels for <code>framework.atoms</code>. Precisely, for <code>atom</code> in <code>framework.atoms</code>, find the first number that appears in <code>atom</code>. Remove this number and all following characters from <code>atom</code>. e.g. C12 –&gt; C    Ba12A_3 –&gt; Ba</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework containing the crystal structure information</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L477-L488' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.chemical_formula' href='#PorousMaterials.chemical_formula'>#</a>
<strong><code>PorousMaterials.chemical_formula</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>formula = chemical_formula(framework, verbose=false)
</code></pre>

<p>Find the irreducible chemical formula of a crystal structure.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework containing the crystal structure information</li>
<li><code>verbose::Bool</code>: If <code>true</code>, will print the chemical formula as well</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>formula::Dict{Symbol, Int}</code>: A dictionary with the irreducible chemical formula of a crystal structure</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L505-L516' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.molecular_weight' href='#PorousMaterials.molecular_weight'>#</a>
<strong><code>PorousMaterials.molecular_weight</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>mass_of_framework = molecular_weight(framework)
</code></pre>

<p>Calculates the molecular weight of a unit cell of the framework in amu using information stored in <code>data/atomicmasses.csv</code>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework containing the crystal structure information</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>mass_of_framework::Float64</code>: The molecular weight of a unit cell of the framework in amu</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L545-L556' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.crystal_density' href='#PorousMaterials.crystal_density'>#</a>
<strong><code>PorousMaterials.crystal_density</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>ρ = crystal_density(framework) # kg/m²
</code></pre>

<p>Compute the crystal density of a framework. Pulls atomic masses from <a href="../other/#PorousMaterials.read_atomic_masses"><code>read_atomic_masses</code></a>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework containing the crystal structure information</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>ρ::Float64</code>: The crystal density of a framework in kg/m³</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L568-L578' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.replicate-Tuple{Framework,Tuple{Int64,Int64,Int64}}' href='#PorousMaterials.replicate-Tuple{Framework,Tuple{Int64,Int64,Int64}}'>#</a>
<strong><code>PorousMaterials.replicate</code></strong> &mdash; <em>Method</em>.</p>
<pre><code>replicated_frame = replicate(framework, repfactors)
</code></pre>

<p>Replicates the atoms and charges in a <code>Framework</code> in positive directions to construct a new <code>Framework</code>. Note <code>replicate(framework, (1, 1, 1))</code> returns the same <code>Framework</code>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: The framework to replicate</li>
<li><code>repfactors::Tuple{Int, Int, Int}</code>: The factors by which to replicate the crystal structure in each direction.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>replicated_frame::Framework</code>: Replicated framework</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L222-L234' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.charged-Tuple{Framework}' href='#PorousMaterials.charged-Tuple{Framework}'>#</a>
<strong><code>PorousMaterials.charged</code></strong> &mdash; <em>Method</em>.</p>
<pre><code>charged_flag = charged(framework, verbose=false) # true or false
</code></pre>

<p>Determine if a framework has point charges</p>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L464-L468' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.write_cif' href='#PorousMaterials.write_cif'>#</a>
<strong><code>PorousMaterials.write_cif</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>write_cif(framework, filename)
</code></pre>

<p>Write a <code>framework::Framework</code> to a .cif file with <code>filename::AbstractString</code>. If <code>filename</code> does not include the .cif extension, it will automatically be added.</p>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L584-L589' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.assign_charges' href='#PorousMaterials.assign_charges'>#</a>
<strong><code>PorousMaterials.assign_charges</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>new_framework = assign_charges(framework, charges, net_charge_tol=1e-5)
</code></pre>

<p>Assign charges to the atoms present in the framework. Pass a dictionary of charges that place charges according to the species of the atoms or pass an array of charges to assign to each atom, with the order of the array consistent with the order of <code>framework.atoms</code>.</p>
<p>If the framework already has charges, the charges are removed and new charges are added accordingly so that <code>framework.atoms.n_atoms == framework.charges.n_charges</code>.</p>
<p><strong>Examples</strong></p>
<pre><code>charges = Dict(:Ca =&gt; 2.0, :C =&gt; 1.0, :H =&gt; -1.0)
new_framework = assign_charges(framework, charges)
</code></pre>

<pre><code>charges = [4.0, 2.0, -6.0] # framework.atoms is length 3
new_framework = assign_charges(framework, charges)
</code></pre>

<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: the framework to which we should add charges (not modified in</li>
</ul>
<p>this function)</p>
<ul>
<li><code>charges::Union{Dict{Symbol, Float64}, Array{Float64, 1}}</code>: a dictionary that returns the</li>
</ul>
<p>charge assigned to the species of atom or an array of charges to assign, with order consistent with the order in <code>framework.atoms</code> (units: electrons).</p>
<ul>
<li><code>net_charge_tol::Float64</code>: the net charge tolerated when asserting charge neutrality of</li>
</ul>
<p>the resulting framework</p>
<p><strong>Returns</strong></p>
<ul>
<li><code>new_framework::Framework</code>: a new framework identical to the one passed except charges</li>
</ul>
<p>are assigned.</p>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Crystal.jl#L637-L671' class='documenter-source'>source</a><br></p>
<p><a id='Grids-1'></a></p>
<h2 id="grids">Grids<a class="headerlink" href="#grids" title="Permanent link">#</a></h2>
<p><a id='PorousMaterials.Grid' href='#PorousMaterials.Grid'>#</a>
<strong><code>PorousMaterials.Grid</code></strong> &mdash; <em>Type</em>.</p>
<p>Data structure for a regular [equal spacing between points in each coordinate] grid of points superimposed on a unit cell box (<code>Box</code>). Each grid point has data, <code>data</code>, associated with it, of type <code>T</code>, stored in a 3D array.</p>
<p><strong>Attributes</strong></p>
<ul>
<li><code>box::Box</code>: describes Bravais lattice over which a grid of points is super-imposed. grid points on all faces are included.</li>
<li><code>n_pts::Tuple{Int, Int, Int}</code>: number of grid points in x, y, z directions. 0 and 1 fractional coordinates are included.</li>
<li><code>data::Array{T, 3}</code>: three dimensional array conaining data associated with each grid point.</li>
<li><code>units::Symbol</code>: the units associated with each data point.</li>
<li><code>origin::Array{Float64, 1}</code>: the origin of the grid.</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Grid.jl#L1-L11' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.apply_periodic_boundary_condition!' href='#PorousMaterials.apply_periodic_boundary_condition!'>#</a>
<strong><code>PorousMaterials.apply_periodic_boundary_condition!</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>apply_periodic_boundary_condition!(molecule)
</code></pre>

<p>Check if the <code>center_of_mass</code> of a <code>Molecule</code> is outside of a <code>Box</code>. If so, apply periodic boundary conditions and translate the center of mass of the <code>Molecule</code> (and its atoms and point charges) so that it is inside of the <code>Box</code>.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>molecule::Molecule</code>: A molecule we're interested in seeing if its' center of mass falls within <code>simulation_box</code></li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/MChelpers.jl#L50-L59' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.write_cube' href='#PorousMaterials.write_cube'>#</a>
<strong><code>PorousMaterials.write_cube</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>write_cube(grid, filename, verbose=true)
</code></pre>

<p>Write grid to a .cube file format. This format is described here: http://paulbourke.net/dataformats/cube/ The atoms of the unit cell are not printed in the .cube. Instead, use .xyz files to also visualize atoms.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>grid::Grid</code>: grid with associated data at each grid point.</li>
<li><code>filename::AbstractString</code>: name of .cube file to which we write the grid; this is relative to <code>PorousMaterials.PATH_TO_DATA</code>/grids/.</li>
<li><code>verbose::Bool</code>: print name of file after writing.</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Grid.jl#L36-L47' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.read_cube' href='#PorousMaterials.read_cube'>#</a>
<strong><code>PorousMaterials.read_cube</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>grid = read_cube(filename)
</code></pre>

<p>Read a .cube file and return a populated <code>Grid</code> data structure.</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>filename::AbstractString</code>: name of .cube file to which we write the grid; this is relative to <code>PorousMaterials.PATH_TO_DATA</code>grids/.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>grid::Grid</code>: A grid data structure</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Grid.jl#L89-L99' class='documenter-source'>source</a><br></p>
<p><a id='PorousMaterials.energy_grid' href='#PorousMaterials.energy_grid'>#</a>
<strong><code>PorousMaterials.energy_grid</code></strong> &mdash; <em>Function</em>.</p>
<pre><code>grid = energy_grid(framework, molecule, ljforcefield; n_pts=(50, 50, 50), temperature=298.0, n_rotations=750)
</code></pre>

<p>Superimposes a regular grid of points (regularly spaced in fractional coordinates of the <code>framework.box</code>) over the unit cell of a crystal, with <code>n_gridpts</code> dictating the number of grid points in the a, b, c directions (including 0 and 1 fractional coords). The fractional coordinates 0 and 1 are included in the grid, although they are redundant. Then, at each grid point, calculate the ensemble average potential energy of the molecule when its mass is centered at that point. The average is taken over Boltzmann-weighted rotations.</p>
<p>The ensemble average is a Boltzmann average over rotations:  - R T log ⟨e⁻ᵇᵁ⟩</p>
<p><strong>Arguments</strong></p>
<ul>
<li><code>framework::Framework</code>: crystal in which we seek to compute an energy grid for a molecule. <code>grid.box</code> will be <code>framework.box</code>.</li>
<li><code>molecule::Molecule</code>: molecule for which we seek an energy grid</li>
<li><code>ljforcefield::LJForceField</code>: molecular model for computing molecule-framework interactions</li>
<li><code>n_pts::Tuple{Int, Int, Int}=(50,50,50)</code>: number of grid points in each fractional coordinate dimension, including endpoints (0, 1)</li>
<li><code>n_rotations::Int</code>: number of random rotations to conduct in a Monte Carlo simulation for finding the free energy of a molecule centered at a given grid point.</li>
</ul>
<p>This is only relevant for molecules that are comprised of more than one Lennard Jones sphere.</p>
<ul>
<li><code>temperature::Float64</code>: the temperature at which to compute the free energy for molecules where rotations are required. Lower temperatures overemphasize the minimum potential energy rotational conformation at that point.</li>
<li><code>units::Symbol</code>: either <code>:K</code> or <code>:kJ_mol</code>, the units in which the energy should be stored in the returned <code>Grid</code>.</li>
<li><code>center::Bool</code>: shift coords of grid so that the origin is the center of the unit cell <code>framework.box</code>.</li>
<li><code>verbose::Bool=true</code>: print some information.</li>
</ul>
<p><strong>Returns</strong></p>
<ul>
<li><code>grid::Grid</code>: A grid data structure containing the potential energy of the system</li>
</ul>
<p><a target='_blank' href='https://github.com/SimonEnsemble/PorousMaterials.jl/blob/6c398b753a4610dde389061222d5b0b999a5518a/src/Grid.jl#L155-L178' class='documenter-source'>source</a><br></p>

  <br>
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../molecules/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../molecules/" class="btn btn-xs btn-link">
        Molecules
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../matter/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../matter/" class="btn btn-xs btn-link">
        Matter
      </a>
    </div>
    
  </div>

    <br>
</div>

<footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/SimonEnsemble/PorousMaterials.jl/edit/master/docs/manual/boxes_crystals_grids.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

</body>
</html>
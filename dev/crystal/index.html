<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>crystals · PorousMaterials.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">PorousMaterials.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PorousMaterials</a></li><li><a class="tocitem" href="../paths/">paths</a></li><li><a class="tocitem" href="../matter/">matter</a></li><li><a class="tocitem" href="../box/">boxes</a></li><li class="is-active"><a class="tocitem" href>crystals</a><ul class="internal"><li><a class="tocitem" href="#reading-in-a-crystal-structure-file"><span>reading in a crystal structure file</span></a></li><li><a class="tocitem" href="#fixing-atom-species"><span>fixing atom species</span></a></li><li><a class="tocitem" href="#converting-the-coordinates-to-cartesian-space"><span>converting the coordinates to cartesian space</span></a></li><li><a class="tocitem" href="#creating-a-super-cell"><span>creating a super cell</span></a></li><li><a class="tocitem" href="#finding-other-properties"><span>finding other properties</span></a></li><li><a class="tocitem" href="#assigning-new-charges"><span>assigning new charges</span></a></li><li><a class="tocitem" href="#writing-crystal-files"><span>writing crystal files</span></a></li><li class="toplevel"><a class="tocitem" href="#detailed-docs"><span>detailed docs</span></a></li></ul></li><li><a class="tocitem" href="../molecule/">molecules</a></li><li><a class="tocitem" href="../distance/">computing distances</a></li><li><a class="tocitem" href="../force_field/">forcefields</a></li><li><a class="tocitem" href="../eos/">equations of state</a></li><li><a class="tocitem" href="../henry/">Henry coefficients</a></li><li><a class="tocitem" href="../gcmc/">grand-canonical Monte Carlo simulations</a></li><li><a class="tocitem" href="../energy_min/">energy minimum</a></li><li><a class="tocitem" href="../grid/">grids</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>crystals</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>crystals</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/master/docs/src/crystal.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Crystals"><a class="docs-heading-anchor" href="#Crystals">Crystals</a><a id="Crystals-1"></a><a class="docs-heading-anchor-permalink" href="#Crystals" title="Permalink"></a></h1><p><code>PorousMaterials.jl</code> maintains a data structure <code>Crystal</code> that stores information about a crystal structure file.</p><h2 id="reading-in-a-crystal-structure-file"><a class="docs-heading-anchor" href="#reading-in-a-crystal-structure-file">reading in a crystal structure file</a><a id="reading-in-a-crystal-structure-file-1"></a><a class="docs-heading-anchor-permalink" href="#reading-in-a-crystal-structure-file" title="Permalink"></a></h2><p>Currently, the crystal structure file reader accepts <code>.cif</code> and <code>.cssr</code> file formats. <code>PorousMaterials.jl</code> looks for the crystal structure files in <code>rc[:paths][:crystals]</code> which is by default <code>./data/crystals</code>. By typing <code>rc[:paths][:crystals] = &quot;my_crystal_dir&quot;</code>, <code>PorousMaterials.jl</code> now looks for the crystal structure file in <code>my_crystal_dir</code>. The files can be read as:</p><pre><code class="language-julia hljs">xtal = Crystal(&quot;SBMOF-1.cif&quot;)       # The crystal reader stores the information in xtal
xtal.name                           # The name of the crystal structure file
xtal.box                            # The unit cell information
xtal.atoms                          # The atom coordinates (in fractional space) and the atom identities
xtal.charges                        # The charge magnitude and coordinates (in fractional space)
xtal.bonds                          # Bonding information in the structure. By default this is an empty graph,
                                    #  but use `read_bonds_from_file=true` argument in `Crystal` to read from crystal structure file
xtal.symmetry                       # Symmetry information of the crystal. By default converts the symmetry to P1 symmetry.
                                    #  Use `convert_to_p1=false` argument in `Crystal` to keep original symmetry</code></pre><h2 id="fixing-atom-species"><a class="docs-heading-anchor" href="#fixing-atom-species">fixing atom species</a><a id="fixing-atom-species-1"></a><a class="docs-heading-anchor-permalink" href="#fixing-atom-species" title="Permalink"></a></h2><p>Often, the atoms species are appended by numbers. This messes with the internal workings of <code>PorousMaterials.jl</code>. To circumvent this problem, the function <code>strip_numbers_from_atom_labels!(xtal)</code> removes the appending numbers. It is important to use this function prior to GCMC or Henry coefficient calculations.</p><pre><code class="language-julia hljs">strip_numbers_from_atom_labels!(xtal)

# output</code></pre><h2 id="converting-the-coordinates-to-cartesian-space"><a class="docs-heading-anchor" href="#converting-the-coordinates-to-cartesian-space">converting the coordinates to cartesian space</a><a id="converting-the-coordinates-to-cartesian-space-1"></a><a class="docs-heading-anchor-permalink" href="#converting-the-coordinates-to-cartesian-space" title="Permalink"></a></h2><p>The coordinates of the crystals are stored in fractional coordinates. If one needs to analyze the cartesian coordinates of the crystal, that can be done by using the unit cell information of the crystal.</p><pre><code class="language-julia hljs">xtal.atoms.coords.xf                                    # array of fractional coordinates
cart_coords = xtal.box.f_to_c * xtal.atoms.coords.xf    # array of cartesian coordinates
# output
3×120 Matrix{Float64}:
 4.59487  -0.95272   2.68943   8.23701  …  8.8164    0.839249  -1.53211
 1.43955   4.2229    4.12715   1.3438      1.35443   1.42892    4.21227
 5.89964   5.35922  16.6181   17.1585      6.27862  17.5375    16.2391</code></pre><h2 id="creating-a-super-cell"><a class="docs-heading-anchor" href="#creating-a-super-cell">creating a super cell</a><a id="creating-a-super-cell-1"></a><a class="docs-heading-anchor-permalink" href="#creating-a-super-cell" title="Permalink"></a></h2><p>For many simulations, one needs to replicate the unit cell multiple times to create a bigger super cell.</p><pre><code class="language-julia hljs">super_xtal = replicate(xtal, (2,2,2))       # Replicates the original unit cell once in each dimension
# output
Name: SBMOF-1.cif
Bravais unit cell of a crystal.
	Unit cell angles α = 90.000000 deg. β = 100.897000 deg. γ = 90.000000 deg.
	Unit cell dimensions a = 23.238600 Å. b = 11.133400 Å, c = 45.862400 Å
	Volume of unit cell: 11651.776815 Å³

	# atoms = 960
	# charges = 960
	chemical formula: Ca₃₂C₄₄₈H₂₅₆O₁₉₂S₃₂
	space Group: P1
	symmetry Operations:
		&#39;x, y, z&#39;
	bonding graph:
		# vertices = 960
		# edges = 0</code></pre><h2 id="finding-other-properties"><a class="docs-heading-anchor" href="#finding-other-properties">finding other properties</a><a id="finding-other-properties-1"></a><a class="docs-heading-anchor-permalink" href="#finding-other-properties" title="Permalink"></a></h2><pre><code class="language-julia hljs">rho = crystal_density(xtal)         # Crystal density of the crystal in kg/m^2
mw = molecular_weight(xtal)         # The molecular weight of the unit cell in amu
formula = chemical_formula(xtal)    # The irreducible chemical formula of the crystal</code></pre><h2 id="assigning-new-charges"><a class="docs-heading-anchor" href="#assigning-new-charges">assigning new charges</a><a id="assigning-new-charges-1"></a><a class="docs-heading-anchor-permalink" href="#assigning-new-charges" title="Permalink"></a></h2><p>If the crystal structure file does not contains partial charges, we provide methods to assign new charges to the crystal</p><pre><code class="language-julia hljs">species_to_charges = Dict(:Ca =&gt; 2.0, :C =&gt; 1.0, :H =&gt; -1.0)                # This method assigns a static charge to atom species
charged_xtal = assign_charges(xtal, species_to_charges, 1e-5)                # This function creates a new charged `Crystal` object.
                                                                            #   The function checks for charge neutrality with a tolerance of 1e-5
new_charges = Charges([2.0, 1.0, -1.0, -1.0, ...], xtal.atoms.coords)
other_charged_xtal = Crystal(xtal.name, xtal.box, xtal.atoms,               # Here we create a new `Charges` object using an array of new charges.
                             new_charges, xtal.bonds, xtal.symmetry)        #   The number of charges in the array has to be equal to the number of atoms
                                                                            #   and finally a new `Crystal` object is manually created</code></pre><h2 id="writing-crystal-files"><a class="docs-heading-anchor" href="#writing-crystal-files">writing crystal files</a><a id="writing-crystal-files-1"></a><a class="docs-heading-anchor-permalink" href="#writing-crystal-files" title="Permalink"></a></h2><p>We provide methods to write both <code>.xyz</code> and <code>.cif</code> files</p><pre><code class="language-julia hljs">write_cif(xtal, &quot;my_new_cif_file.cif&quot;)      # Stored in the current directory
write_xyz(xtal, &quot;my_new_xyz_file.xyz&quot;)      # stored in the current directory</code></pre><h1 id="detailed-docs"><a class="docs-heading-anchor" href="#detailed-docs">detailed docs</a><a id="detailed-docs-1"></a><a class="docs-heading-anchor-permalink" href="#detailed-docs" title="Permalink"></a></h1><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>Crystal</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>SymmetryInfo</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>replicate</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>molecular_weight</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>crystal_density</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>chemical_formula</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>assign_charges</code>. Check Documenter&#39;s build log for details.</p></div></div><div class="admonition is-warning"><header class="admonition-header">Missing docstring.</header><div class="admonition-body"><p>Missing docstring for <code>write_cif</code>. Check Documenter&#39;s build log for details.</p></div></div><article class="docstring"><header><a class="docstring-binding" id="Xtals.write_xyz" href="#Xtals.write_xyz"><code>Xtals.write_xyz</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">write_xyz(box, molecules, xyz_file)</code></pre><p>Writes the coordinates of all atoms in molecules to the given xyz_file file object passing a file object around is faster for simulation because it can be opened once at the beginning of the simulation and closed at the end.</p><p>This writes the coordinates of the molecules in cartesian coordinates, so the box is needed for the conversion.</p><p><strong>Arguments</strong></p><ul><li><code>box::Box</code>: The box the molecules are in, to convert molecule positions      to cartesian coordinates</li><li><code>molecules::Array{Array{Molecule{Frac}, 1}, 1}</code>: The array containing arrays of molecules, separated by species, to be written to the file</li><li><code>xyz_file::IOStream</code>: The open &#39;write&#39; file stream the data will be saved to</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/881983c461edf1a93bb810ff5c60dc2c194133da/src/molecule.jl#L110-L124">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../box/">« boxes</a><a class="docs-footer-nextpage" href="../molecule/">molecules »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 14 September 2022 20:20">Wednesday 14 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>

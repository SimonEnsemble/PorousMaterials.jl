<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>molecules · PorousMaterials.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/flux.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">PorousMaterials.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">PorousMaterials</a></li><li><a class="tocitem" href="../matter/">matter</a></li><li><a class="tocitem" href="../box/">boxes</a></li><li><a class="tocitem" href="../crystal/">crystals</a></li><li class="is-active"><a class="tocitem" href>molecules</a><ul class="internal"><li><a class="tocitem" href="#Loading-Molecule-Files"><span>Loading Molecule Files</span></a></li><li><a class="tocitem" href="#Building-Blocks-of-PorousMaterials:-Molecules"><span>Building Blocks of PorousMaterials: Molecules</span></a></li><li><a class="tocitem" href="#Moving-Molecules"><span>Moving Molecules</span></a></li><li class="toplevel"><a class="tocitem" href="#detailed-docs"><span>detailed docs</span></a></li><li><a class="tocitem" href="#Molecules-2"><span>Molecules</span></a></li><li><a class="tocitem" href="#Molecular-Movement"><span>Molecular Movement</span></a></li></ul></li><li><a class="tocitem" href="../distance/">computing distances</a></li><li><a class="tocitem" href="../force_field/">forcefields</a></li><li><a class="tocitem" href="../eos/">equations of state</a></li><li><a class="tocitem" href="../henry/">Henry coefficients</a></li><li><a class="tocitem" href="../gcmc/">grand-canonical Monte Carlo simulations</a></li><li><a class="tocitem" href="../energy_min/">energy minimum</a></li><li><a class="tocitem" href="../grid/">grids</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>molecules</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>molecules</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/master/docs/src/molecule.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Molecules"><a class="docs-heading-anchor" href="#Molecules">Molecules</a><a id="Molecules-1"></a><a class="docs-heading-anchor-permalink" href="#Molecules" title="Permalink"></a></h1><h2 id="Loading-Molecule-Files"><a class="docs-heading-anchor" href="#Loading-Molecule-Files">Loading Molecule Files</a><a id="Loading-Molecule-Files-1"></a><a class="docs-heading-anchor-permalink" href="#Loading-Molecule-Files" title="Permalink"></a></h2><p>Molecule input files are stored in <code>PorousMaterials.PATH_TO_MOLECULES</code>. Each molecule possesses its own directory containing two files: <code>charges.csv</code> and <code>atoms.csv</code>, comma-separated-value files, which describe the point charges and Lennard Jones spheres, respectively, that compose the molecule. Only rigid molecules are currently supported. Units of length are in Angstroms (<span>$\AA$</span>); units of charges are electrons.</p><pre><code class="language-julia">using PorousMaterials

molecule = Molecule(&quot;CO2&quot;)</code></pre><p>PorousMaterials will then output information about the molecule you just loaded:</p><pre><code class="language-julia">Molecule species: CO2
Center of mass (fractional coords): Cart([0.0; 0.0; 0.0])
Atoms:

	atom = C_CO2, x = [0.000, 0.000, 0.000]
	atom = O_CO2, x = [-1.160, 0.000, 0.000]
	atom = O_CO2, x = [1.160, 0.000, 0.000]
Point charges: 
	charge = 0.700000, x = [0.000, 0.000, 0.000]
	charge = -0.350000, x = [-1.160, 0.000, 0.000]
	charge = -0.350000, x = [1.160, 0.000, 0.000]</code></pre><h2 id="Building-Blocks-of-PorousMaterials:-Molecules"><a class="docs-heading-anchor" href="#Building-Blocks-of-PorousMaterials:-Molecules">Building Blocks of PorousMaterials: Molecules</a><a id="Building-Blocks-of-PorousMaterials:-Molecules-1"></a><a class="docs-heading-anchor-permalink" href="#Building-Blocks-of-PorousMaterials:-Molecules" title="Permalink"></a></h2><pre><code class="language-julia">molecule = Molecule(&quot;CO2&quot;) # fractional coords in terms of unit cube box

# access the attributes that comprise the molecule object
molecule.species   # molecule species
molecule.com       # center-of-mass
molecule.atoms     # Lennard-Jones spheres
molecule.charges   # point charges </code></pre><p>To see specific information about the atoms and charges attributes of the molecule see <a href="../matter/#PorousMaterials.Atoms"><code>Atoms</code></a> and <a href="../matter/#PorousMaterials.Charges"><code>Charges</code></a>.</p><h2 id="Moving-Molecules"><a class="docs-heading-anchor" href="#Moving-Molecules">Moving Molecules</a><a id="Moving-Molecules-1"></a><a class="docs-heading-anchor-permalink" href="#Moving-Molecules" title="Permalink"></a></h2><p>We can translate and roatate a molecule:</p><pre><code class="language-julia">using PorousMaterials

# load a molecule and convert it to Molecule{Frac}
molecule = Molecule(&quot;CO2&quot;)
molecule = Frac(molecule, unit_cube())

# translate center-of-mass to [1.0, 2.0, 3.0] in fractional coordinates
x = Cart([1.0, 2.0, 3.0])
translate_to!(molecule, x, unit_cube())

# translate by [0.1, 0.0, 0.0] in fractional coordinates
dx = Cart([0.1, 0.0, 0.0])
translate_by!(molecule, dx, unit_cube())

# conduct a uniform random rotation about the center-of-mass
random_rotation!(molecule, unit_cube()) </code></pre><h1 id="detailed-docs"><a class="docs-heading-anchor" href="#detailed-docs">detailed docs</a><a id="detailed-docs-1"></a><a class="docs-heading-anchor-permalink" href="#detailed-docs" title="Permalink"></a></h1><h2 id="Molecules-2"><a class="docs-heading-anchor" href="#Molecules-2">Molecules</a><a class="docs-heading-anchor-permalink" href="#Molecules-2" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.Molecule" href="#PorousMaterials.Molecule"><code>PorousMaterials.Molecule</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Data structure for a molecule/adsorbate.</p><p><strong>Attributes</strong></p><ul><li><code>species::Symbol</code>: Species of molecule, e.g. <code>:CO2</code></li><li><code>atoms::Atoms</code>: array of Lennard-Jones spheres comprising the molecule</li><li><code>charges::Charges</code>: array of point charges comprising the molecule</li><li><code>com::Coords</code>: center of mass</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L5-L13">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.translate_to!" href="#PorousMaterials.translate_to!"><code>PorousMaterials.translate_to!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">translate_to!(molecule, xf)
translate_to!(molecule, x)
translate_to!(molecule, xf, box)
translate_to!(molecule, x, box)</code></pre><p>Translate a molecule so that its center of masss is at a point <code>xf</code> in fractional coordinate space or at <code>x</code> in Cartesian coordinate space. For the latter, a unit cell box is required for context.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L154-L162">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.random_rotation!" href="#PorousMaterials.random_rotation!"><code>PorousMaterials.random_rotation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">random_rotation!(molecule{Frac}, box)
random_rotation!(molecule{Cart})</code></pre><p>randomly rotate a molecule about its center of mass.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L238-L243">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.random_rotation_matrix-Tuple{}" href="#PorousMaterials.random_rotation_matrix-Tuple{}"><code>PorousMaterials.random_rotation_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">r = random_rotation_matrix() # rotation matrix in cartesian coords</code></pre><p>Generate a 3x3 random rotation matrix <code>r</code> such that when a point <code>x</code> is rotated using this rotation matrix via <code>r * x</code>,  this point <code>x</code> is placed at a uniform random distributed position on the surface of a sphere of radius <code>norm(x)</code>. the point <code>x</code> is in Cartesian coordinates here. See James Arvo. Fast Random Rotation Matrices.</p><p>https://pdfs.semanticscholar.org/04f3/beeee1ce89b9adf17a6fabde1221a328dbad.pdf</p><p><strong>Returns</strong></p><ul><li><code>r::Array{Float64, 2}</code>: A 3x3 random rotation matrix</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L210-L222">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.ion" href="#PorousMaterials.ion"><code>PorousMaterials.ion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">molecule = ion(q, coords)</code></pre><p>Facilitate constructing a point charge by constructing a molecule: Molecule(:ion, Atoms{Frac}(0), Charges(q, coords), coords)</p><p><strong>Arguments</strong></p><ul><li><code>q::Float64</code>: value of point charge, units: electrons</li><li><code>coords::Frac</code>: fractional coordinates of the charge</li></ul><p><strong>Returns</strong></p><ul><li><code>molecule::Molecule{Frac}</code>: the ion as a molecule with Fractional coordinates</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L306-L316">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.distortion" href="#PorousMaterials.distortion"><code>PorousMaterials.distortion</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">is_distorted = distortion(molecule, ref_molecule, box; 
                          atol=1e-12, throw_warning=true)</code></pre><p>Determine whether a molecule has distortion w.r.t. a reference molecule via pairwise distance comparison of the atoms and charges coordinates.</p><p><strong>Arguments</strong></p><ul><li><code>molecule::Molecule{Frac}</code>: molecule you want to compare</li><li><code>ref_molecule::Molecule{Frac}</code>: reference molecule</li><li><code>box::Box</code>: box used for the fractional coordinates</li><li><code>atol::Float64=1e-12</code>: absolute tolerance for distance comparison</li><li><code>throw_warning::Bool=true</code>: issue a warning if there is distortion</li></ul><p><strong>Returns</strong></p><ul><li><code>is_distorted::Bool</code>: true if there is distortion w.r.t. reference molecule </li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/molecule.jl#L322-L336">source</a></section></article><h2 id="Molecular-Movement"><a class="docs-heading-anchor" href="#Molecular-Movement">Molecular Movement</a><a id="Molecular-Movement-1"></a><a class="docs-heading-anchor-permalink" href="#Molecular-Movement" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.apply_periodic_boundary_condition!" href="#PorousMaterials.apply_periodic_boundary_condition!"><code>PorousMaterials.apply_periodic_boundary_condition!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">apply_periodic_boundary_condition!(molecule::Molecule{Frac})</code></pre><p>Check if each of a molecule&#39;s center-of-mass coordinates is within the bounds (0.0, 1.0) in fractional coordinates, and translate if needed.  </p><p><strong>Arguments</strong></p><ul><li><code>molecule::Molecule{Frac}</code>: the molecule to be checked</li></ul><p><strong>Returns</strong></p><ul><li><code>nothing</code>, if the molecule is within the boundary; ohterwise, the coordinates of the input molecule will be modified</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L56-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.random_insertion!" href="#PorousMaterials.random_insertion!"><code>PorousMaterials.random_insertion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">random_insertion!(molecules::Array{Molecule{Frac}, 1}, box::Box, template::Molecule{Cart})</code></pre><p>Insert a molecule into the simulation box and perform a random rotation if needed.</p><p><strong>Arguments</strong></p><ul><li><code>molecules::Array{Molecule{Frac}, 1}</code>: array containing the molecules in the simulation</li><li><code>box::Box</code>: the box  used for fractional coordinats</li><li><code>template::Molecule{Cart}</code>: reference molecule of the type inserted</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L17-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.remove_molecule!" href="#PorousMaterials.remove_molecule!"><code>PorousMaterials.remove_molecule!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">remove_molecule!(molecule_id, molecules)</code></pre><p>Remove a molecule from the array of molecules.</p><p><strong>Arguments</strong></p><ul><li><code>molecule_id::Int</code>: the ID of the molecule to be removed</li><li><code>molecules::Array{&lt;:Molecule, 1}</code>: array of molecules to be modified</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L43-L51">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.random_translation!" href="#PorousMaterials.random_translation!"><code>PorousMaterials.random_translation!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">random_reinsertion!(molecule, box)</code></pre><p>Perform a translational perturbation in Cartesian coordinates on a molecule, apply the periodic boundry conditions, and keep a copy of the original in case it needs to be restored.</p><p><strong>Arguements</strong></p><ul><li><code>molecule::Molecule{Frac}</code>: molecule to be translated</li><li><code>box::Box</code>: the box used in rotation</li></ul><p><strong>Returns</strong></p><ul><li><code>old_molecule::Molecule{Frac}</code>: a copy of the original molecule</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L90-L101">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.random_reinsertion!" href="#PorousMaterials.random_reinsertion!"><code>PorousMaterials.random_reinsertion!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">random_reinsertion!(molecule, box)</code></pre><p>Perform a translation and rotated (if needed) on a molecule, and keep a copy of the original in case it needs to be restored.</p><p><strong>Arguements</strong></p><ul><li><code>molecule::Molecule{Frac}</code>: molecule to be translated and rotated (if needed)</li><li><code>box::Box</code>: the box used in rotation</li></ul><p><strong>Returns</strong></p><ul><li><code>old_molecule::Molecule{Frac}</code>: a copy of the original molecule</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L116-L127">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="PorousMaterials.needs_rotations" href="#PorousMaterials.needs_rotations"><code>PorousMaterials.needs_rotations</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">needs_rotations(molecule) # true or false</code></pre><p>Determine whether a molecule needs to undergo rotation.</p><pre><code class="language-none">`true` if molecule.atoms.n + molecule.charges.n &gt; 1</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/SimonEnsemble/PorousMaterials.jl/blob/7c97e031087f0da6531d2dafcf8a2b925ece31a5/src/mc_helpers.jl#L5-L11">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../crystal/">« crystals</a><a class="docs-footer-nextpage" href="../distance/">computing distances »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Sunday 4 April 2021 17:53">Sunday 4 April 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
